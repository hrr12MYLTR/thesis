enable sudo: required
language: node_js
node_js:
  - '5.5.0'
before_install:
   - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
   - sudo apt-get update -q
   - sudo apt-get install gcc-4.8 -y
   - echo "Installing libvips..."
   - sudo add-apt-repository -y ppa:lovell/precise-backport-vips
   - sudo apt-get update
   - sudo apt-get install -y libvips-dev
   - echo "Completed libvips installation."
before_script:
  - bower install
  - wget http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest.tar.gz -O /tmp/dynamodb_local_latest.tar.gz
  - tar -xzf /tmp/dynamodb_local_latest.tar.gz -C /tmp
  - java -Djava.library.path=/tmp/DynamoDBLocal_lib -jar /tmp/DynamoDBLocal.jar -inMemory &
  - sleep 2
  - node db/db.js
  - npm install -g nodemon
  - npm start &
  - sleep 5
script: npm test
env:
  - CXX=g++-4.8
addons:
  hosts:
    - dynamodb-local
  apt:
      sources:
        - ubuntu-toolchain-r-test
      packages:
        - g++-4.8
